<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì£¼ê°€ ìƒìŠ¹ ì˜ˆì¸¡ ê³„ì‚°ê¸°</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', 'Noto Sans KR', sans-serif;
    }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }
  </style>
</head>
<body class="bg-slate-100">
<div class="flex h-screen">
  <div class="w-1/6 p-4 bg-gray-200">
    <ul class="space-y-2">
      <li><a href="index.html" class="text-blue-600 hover:underline">ë¬¼íƒ€ê¸° ê³„ì‚°ê¸°</a></li>
      <li><a href="rise_calculator.html" class="text-blue-600 hover:underline font-bold">ìƒìŠ¹ë¥  ê³„ì‚°ê¸°</a></li>
      <li><a href="charts_examples.html" class="text-blue-600 hover:underline">ìƒ˜í”Œ ì°¨íŠ¸</a></li>
    </ul>
  </div>

  <div class="w-3/4 p-4 overflow-y-auto">
    <div class="calculator-container bg-white p-6 sm:p-8 rounded-2xl shadow-lg w-full max-w-lg mx-auto">
      <div class="text-center mb-6">
        <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">ì£¼ê°€ ìƒìŠ¹ ì˜ˆì¸¡ ê³„ì‚°ê¸°</h1>
        <p class="text-sm sm:text-base text-slate-500 mt-2">
          í˜„ì¬ ì£¼ê°€ì™€ ë³´ìœ  ìˆ˜ëŸ‰, ê¸°ëŒ€ ìƒìŠ¹ë¥ ì„ ì…ë ¥í•˜ë©´ ëª©í‘œ ì£¼ê°€ì™€ í‰ê°€ ì†ìµì„ ê³„ì‚°í•©ë‹ˆë‹¤.
        </p>
      </div>

      <form id="rise-calc-form" class="space-y-4">
        <div>
          <label for="current_price" class="block text-sm font-medium text-slate-600 mb-1">í˜„ì¬ ì£¼ê°€ (ì›)</label>
          <input type="number" id="current_price" value="50000" class="w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition" placeholder="ì˜ˆ: 50000" required>
        </div>
        <div>
          <label for="current_shares" class="block text-sm font-medium text-slate-600 mb-1">ë³´ìœ  ì£¼ì‹ ìˆ˜</label>
          <input type="number" id="current_shares" value="100" class="w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition" placeholder="ì˜ˆ: 100" required>
        </div>
        <div>
          <label for="rise_percentage" class="block text-sm font-medium text-slate-600 mb-1">ê¸°ëŒ€ ìƒìŠ¹ë¥  (%)</label>
          <input type="number" id="rise_percentage" value="10" class="w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition" placeholder="ì˜ˆ: 10" required>
        </div>
        <button type="submit" class="w-full py-3 px-4 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-transform transform active:scale-[0.98]">
          ì˜ˆìƒ ê²°ê³¼ í™•ì¸í•˜ê¸°
        </button>
      </form>

      <div id="result" class="result-container mt-6">
      </div>

    </div>
  </div>
</div>

<script>
  const storageKey = 'riseCalcData'; // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì‚¬ìš©í•  í‚¤

  // --- ë°ì´í„° ë¡œë“œ ---
  function loadDataFromStorage() {
    const strData = localStorage.getItem(storageKey);
    if (strData) {
      const data = JSON.parse(strData);
      if (data.current_price)
        document.getElementById('current_price').value = data.current_price;
      if (data.current_shares)
        document.getElementById('current_shares').value = data.current_shares;
      if (data.rise_percentage)
        document.getElementById('rise_percentage').value = data.rise_percentage;
    }
  }

  // --- í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
  document.getElementById('rise-calc-form').addEventListener('submit', function(event) {
    event.preventDefault();

    // 1. ì‚¬ìš©ì ì…ë ¥ ê°’ ê°€ì ¸ì˜¤ê¸°
    const currentPrice = parseFloat(document.getElementById('current_price').value);
    const currentShares = parseInt(document.getElementById('current_shares').value);
    const risePercentage = parseFloat(document.getElementById('rise_percentage').value);

    // 2. ì…ë ¥ ê°’ ìœ íš¨ì„± ê²€ì‚¬
    if (isNaN(currentPrice) || isNaN(currentShares) || isNaN(risePercentage)) {
      displayMessage('ëª¨ë“  ê°’ì„ ìˆ«ìë¡œ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
      return;
    }

    // --- ë°ì´í„° ì €ì¥ ---
    localStorage.setItem(storageKey, JSON.stringify({
      current_price: currentPrice,
      current_shares: currentShares,
      rise_percentage: risePercentage
    }));

    // 3. ê³„ì‚° ë¡œì§ ìˆ˜í–‰
    const targetPrice = currentPrice * (1 + risePercentage / 100);
    const currentValuation = currentPrice * currentShares;
    const targetValuation = targetPrice * currentShares;
    const profit = targetValuation - currentValuation;

    // 4. ê²°ê³¼ ì¶œë ¥
    displayResult({
      targetPrice,
      targetValuation,
      profit
    });
  });

  /** ìˆ«ìë¥¼ í•œêµ­ì‹ í†µí™” í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…í•˜ëŠ” í•¨ìˆ˜ */
  function formatNumber(number, fractionDigits = 0) {
    return number.toLocaleString('ko-KR', {
      minimumFractionDigits: fractionDigits,
      maximumFractionDigits: fractionDigits
    });
  }

  /** ê³„ì‚° ê²°ê³¼ë¥¼ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ */
  function displayResult(data) {
    const resultDiv = document.getElementById('result');
    const profitColorClass = data.profit >= 0 ? 'text-red-600' : 'text-blue-600';
    const profitSign = data.profit >= 0 ? '+' : '';

    resultDiv.innerHTML = `
                <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                    <div class="space-y-3">
                        <div class="flex justify-between items-center text-base sm:text-lg">
                            <span class="font-medium text-slate-700">ğŸ¯ ì˜ˆìƒ ëª©í‘œ ì£¼ê°€</span>
                            <span class="font-bold text-green-600">${formatNumber(data.targetPrice, 2)}ì›</span>
                        </div>
                         <hr class="border-t border-green-200 my-2">
                        <div class="flex justify-between items-center text-sm sm:text-base">
                            <span class="text-slate-600">ğŸ’° ì˜ˆìƒ ì´ í‰ê°€ì•¡</span>
                            <span class="font-bold text-slate-800">${formatNumber(data.targetValuation)}ì›</span>
                        </div>
                        <div class="flex justify-between items-center text-sm sm:text-base">
                            <span class="text-slate-600">ğŸ“ˆ í‰ê°€ ì†ìµ</span>
                            <span class="font-bold ${profitColorClass}">
                                ${profitSign}${formatNumber(data.profit)}ì›
                            </span>
                        </div>
                    </div>
                </div>
            `;
  }

  /** ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ */
  function displayMessage(text, type) {
    const resultDiv = document.getElementById('result');
    const colorClass = type === 'error' ? 'bg-red-50 border-red-200 text-red-700' : 'bg-yellow-50 border-yellow-200 text-yellow-800';
    resultDiv.innerHTML = `
                <div class="${colorClass} p-4 rounded-lg text-center font-medium">
                    ${text}
                </div>
            `;
  }

  // --- í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰ ---
  document.addEventListener('DOMContentLoaded', () => {
    loadDataFromStorage(); // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    document.querySelector('#rise-calc-form button[type="submit"]').click(); // ì´ˆê¸° ê³„ì‚° ì‹¤í–‰
  });
</script>
</body>
</html>